@model CorujaPresentation.Models.EditViewModel
@{
    ViewBag.Title = "Edicao";
}

<!-- EDICAO	================================= -->
<section id="EditSection" class="section section-gray">
  
    <div class="container">

        <h2 class="section-heading text-center">Conta Coruja</h2>

        <div class="row centered-form">

            <div class="col-sm-6 col-sm-offset-3">

                <div class="panel panel-default">

                    <div id="cadTitle">

                        <h3>
                            <i class="glyphicon glyphicon-pencil">
                            </i>
                            Dados Pessoais
                        </h3>

                    </div>

                    <div class="panel-body">

                        @using (Html.BeginForm("Edicao", "Conta", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                        {
                            @Html.AntiForgeryToken()


                            <div class="row cadSectionTitle">
                                <div class="col-sm-12">
                                    Conta Coruja
                                </div>


                            </div>

                            <div class="row cadSection">

                                <div class="col-sm-12">

                                    <div class="form-group">
                                        @*Nome*@
                                        <div class="col-sm-6">
                                            <i class="asteriskCadastro">*</i>
                                            @Html.LabelFor(m => m.FirstName, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.FirstName, new { htmlAttributes = new { @class = "form-control input-sm" } })

                                            @Html.ValidationMessageFor(m => m.FirstName, "", new { @class = "text-danger" })
                                        </div>
                                        @*Sobrenome*@
                                        <div class="col-sm-6">
                                            <i class="asteriskCadastro">*</i>
                                            @Html.LabelFor(m => m.LastName, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.LastName, new { htmlAttributes = new { @class = "form-control input-sm" } })

                                            @Html.ValidationMessageFor(m => m.LastName, "", new { @class = "text-danger" })
                                        </div>

                                    </div>

                                    <div class="form-group">
                                        @*DtNasc*@
                                        <div class="col-sm-4">
                                            @Html.LabelFor(m => m.BirthDate, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(model => model.BirthDate, new { htmlAttributes = new { @type = "text", @class = "form-control input-sm" } })
                                            @Html.ValidationMessageFor(m => m.BirthDate, "", new { @class = "text-danger" })
                                        </div>

                                        @*Cpf*@
                                        <div class="col-sm-4">
                                            <i class="asteriskCadastro">*</i>
                                            @Html.LabelFor(m => m.Cpf, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.Cpf, new { htmlAttributes = new { Id = "Cpf", @class = "form-control input-sm" } })

                                            @Html.ValidationMessageFor(m => m.Cpf, "", new { @class = "text-danger" })
                                        </div>

                                        @*RG*@
                                        <div class="col-sm-4">
                                            @Html.LabelFor(m => m.Rg, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.Rg, new { htmlAttributes = new { @class = "form-control input-sm" } })

                                        </div>
                                    </div>

                                    <div class="form-group">
                                        @*Celular*@
                                        <div class="col-sm-4">
                                            @Html.LabelFor(m => m.CellPhoneNumber, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.CellPhoneNumber, new { htmlAttributes = new { @class = "form-control input-sm" } })
                                        </div>

                                        @*Tel Res.*@
                                        <div class="col-sm-4">
                                            @Html.LabelFor(m => m.PhoneNumber, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.PhoneNumber, new { htmlAttributes = new { @class = "form-control input-sm" } })

                                        </div>

                                    </div>


                                    <div class="form-group">
                                        @*Escolaridade*@
                                        <div class="col-sm-6">
                                            @Html.LabelFor(m => m.Graduation, new { htmlAttributes = new { @class = "" } })
                                            @Html.DropDownListFor(x => x.Graduation, (SelectList)ViewBag.Lst, new { htmlAttributes = new { @class = "form-control input-sm" } })

                                        </div>

                                    </div>

                                </div>

                            </div>

                            @*=============================================================================*@

                            <div class="row cadSectionTitle">
                                <div class="col-sm-12">
                                    Endereço
                                </div>
                            </div>

                            <div class="row cadSection">

                                <div class="col-sm-12">

                                    <div class="form-group">

                                        @*CEP*@
                                        <div class="col-sm-3">
                                            @Html.LabelFor(m => m.Cep, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.Cep, new { htmlAttributes = new { Id = "Cep", @class = "form-control input-sm" } })
                                        </div>

                                        @*ENDERECO*@
                                        <div class="col-sm-9">
                                            @Html.LabelFor(m => m.Address, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.Address, new { htmlAttributes = new { Id = "Address", @class = "form-control input-sm" } })

                                        </div>

                                    </div>

                                    <div class="form-group">
                                        @*Numero*@
                                        <div class="col-sm-2">
                                            @Html.LabelFor(m => m.AddressNumber, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.AddressNumber, new { htmlAttributes = new { Id = "AddressNumber", @class = "form-control input-sm" } })
                                        </div>

                                        @*Complemento*@
                                        <div class="col-sm-4">
                                            @Html.LabelFor(m => m.AddressDetail, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.AddressDetail, new { htmlAttributes = new { Id = "AddressDetail", @class = "form-control input-sm" } })
                                        </div>

                                        @*Bairro*@
                                        <div class="col-sm-6">
                                            @Html.LabelFor(m => m.Nhood, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.Nhood, new { htmlAttributes = new { Id = "Nhood", @class = "form-control input-sm" } })
                                        </div>

                                    </div>

                                    <div class="form-group">

                                        @*Cidade*@
                                        <div class="col-sm-5">
                                            @Html.LabelFor(m => m.City, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.City, new { htmlAttributes = new { Id = "City", @class = "form-control input-sm" } })
                                        </div>

                                        @*UF*@
                                        <div class="col-sm-2">
                                            @Html.LabelFor(m => m.State, new { htmlAttributes = new { @class = "" } })
                                            @Html.DropDownListFor(x => x.State, (SelectList)ViewBag.UfLst, new { Id = "State", htmlAttributes = new { @class = "form-control input-sm" } })


                                        </div>

                                    </div>


                                </div>

                            </div>

                            @*=============================================================================*@

                            <div class="row cadSectionTitle">
                                <div class="col-sm-12">
                                    Email
                                </div>
                            </div>

                            <div class="row">

                                <div class="col-sm-12">

                                    <div class="form-group">

                                        @*EMAIL*@
                                        <div class="col-sm-7">
                                            <i class="asteriskCadastro">*</i>
                                            @Html.LabelFor(m => m.Email, new { htmlAttributes = new { @class = "" } })
                                            @Html.EditorFor(m => m.Email, new { htmlAttributes = new { @class = "form-control input-sm" } })
                                            @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger" })

                                        </div>

                                        <div class="col-sm-4">
                                            <small><label class="checkbox-inline" style="margin-top:35px">@Html.CheckBox("ReceiveNewsletter", false) Aceito receber Newsletter da Coruja</label></small>
                                        </div>

                                    </div>

                                    <div class="form-group">

                                        <div class="col-sm-12 pull-left">
                                            <small>
                                                <i class="asteriskCadastro">*</i> <span id="preenchimento">Preenchimento Obrigatório</span>
                                            </small>

                                        </div>
                                    </div>

                                </div>

                            </div>

                            <div class="row cadSection" style="margin-top:20px">

                                <div class="col-sm-12">

                                    
                                    <div class="form-group">

                                        <div class="col-sm-4 col-sm-offset-7">
                                            <button id="btnEdit" type="submit" class="btn btn-primary">Atualizar Dados</button>
                                        </div>

                                    </div>

                               

                                </div>

                            </div>


                        }

                    </div>

                </div>

            </div>

        </div>


    </div>

</section>


    <script type="text/javascript">

        $(document).ready(function () {

            function limpa_formulário_cep() {
                // Limpa valores do formulário de cep.
                $("#Address").val("");
                $("#Nhood").val("");
                $("#City").val("");
                $("#State").val("");
            }

            //Quando o campo cep perde o foco.
            $("#Cep").blur(function () {

                //Nova variável "cep" somente com dígitos.
                var cep = $(this).val().replace(/\D/g, '');

                //Verifica se campo cep possui valor informado.
                if (cep != "") {

                    //Expressão regular para validar o CEP.
                    var validacep = /^[0-9]{8}$/;

                    //Valida o formato do CEP.
                    if (validacep.test(cep)) {

                        //Preenche os campos com "..." enquanto consulta webservice.
                        $("#Address").val("...")
                        $("#Nhood").val("...")
                        $("#City").val("...")
                        $("#State").val("...")


                        //Consulta o webservice viacep.com.br/
                        $.getJSON("//viacep.com.br/ws/" + cep + "/json/?callback=?", function (dados) {

                            if (!("erro" in dados)) {
                                //Atualiza os campos com os valores da consulta.
                                $("#Address").val(dados.logradouro);
                                $("#Nhood").val(dados.bairro);
                                $("#City").val(dados.localidade);
                                $("#State").val(dados.uf);

                            } //end if.
                            else {
                                //CEP pesquisado não foi encontrado.
                                limpa_formulário_cep();
                                alert("CEP não encontrado.");
                            }
                        });
                    } //end if.
                    else {
                        //cep é inválido.
                        limpa_formulário_cep();
                        alert("Formato de CEP inválido.");
                    }
                } //end if.
                else {
                    //cep sem valor, limpa formulário.
                    limpa_formulário_cep();
                }
            });
        });

    </script>


}


